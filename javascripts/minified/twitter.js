/* Sky Slavin, Ludopoli. MIT license.  * based on JavaScript Pretty Date * Copyright (c) 2008 John Resig (jquery.com) * Licensed under the MIT license.  */
function prettyDate(e){if("Microsoft Internet Explorer"===navigator.appName)return"<span>&infin;</span>";var t={just_now:" now",minute_ago:"1m",minutes_ago:"m",hour_ago:"1h",hours_ago:"h",yesterday:"1d",days_ago:"d",last_week:"1w",weeks_ago:"w"},a=new Date,r=a.getTime(),n=r+6e4,s=new Date(e),i=(n-s.getTime())/1e3,o=Math.floor(i/86400);return isNaN(o)||0>o?"<span>&infin;</span>":0===o&&(60>i&&t.just_now||120>i&&t.minute_ago||3600>i&&Math.floor(i/60)+t.minutes_ago||7200>i&&t.hour_ago||86400>i&&Math.floor(i/3600)+t.hours_ago)||1===o&&t.yesterday||7>o&&o+t.days_ago||7===o&&t.last_week||o>7&&Math.ceil(o/7)+t.weeks_ago}function linkifyTweet(e,t){e=e.replace(/(https?:\/\/)([\w\-:;?&=+.%#\/]+)/gi,'<a href="$1$2">$2</a>').replace(/(^|\W)@(\w+)/g,'$1<a href="https://twitter.com/$2">@$2</a>').replace(/(^|\W)#(\w+)/g,'$1<a href="https://search.twitter.com/search?q=%23$2">#$2</a>');for(var a in t)if(null!=t[a].expanded_url){var r=new RegExp(t[a].url,"g");e=e.replace(r,t[a].expanded_url);var r=new RegExp(">"+t[a].url.replace(/https?:\/\//,""),"g");e=e.replace(r,">"+t[a].display_url)}return e}function showTwitterFeed(e,t){var a=document.getElementById("tweets"),r="";for(var n in e)r+='<li><p><a href="https://twitter.com/'+t+"/status/"+e[n].id_str+'">'+prettyDate(e[n].created_at)+"</a>"+linkifyTweet(e[n].text.replace(/\n/g,"<br>"),e[n].entities.urls)+"</p></li>";a.innerHTML=r}function getTwitterFeed(e,t,a){t=parseInt(t,10),$.ajax({url:"https://api.twitter.com/1/statuses/user_timeline/"+e+".json?trim_user=true&count="+(t+20)+"&include_entities=1&exclude_replies="+(a?"0":"1")+"&callback=?",type:"jsonp",error:function(){$("#tweets li.loading").addClass("error").text("Twitter's busted")},success:function(a){showTwitterFeed(a.slice(0,t),e)}})}